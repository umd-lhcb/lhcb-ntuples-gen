headers:
    system:
        - TLorentzVector.h
    user:
        - functor/basic.h
        - functor/particle.h

keep:
    # Event uid, also needed for keeping only one B for multi-B events
    - runNumber
    - eventNumber
    - GpsTime

rename:
    # For pseudo-random sequence generation
    b0_PT: b0_pt
    # Isolation variables
    b0_ISOLATION_BDT: iso_bdt
    # Triggers
    b0_L0Global_TIS: b0_l0glob_tis
    dst_L0HadronDecision_TOS: dst_l0had_dec_tos
    mu_L0Global_TIS: mu_l0glob_tis
    # B0
    b0_M: b0_m
    # Dst mother
    dst_MC_MOTHER_ID: dst_mc_mom_id
    dst_MC_MOTHER_TRUEPX: dst_mc_mom_px
    dst_MC_MOTHER_TRUEPY: dst_mc_mom_py
    dst_MC_MOTHER_TRUEPZ: dst_mc_mom_pz
    dst_MC_MOTHER_TRUEPE: dst_mc_mom_pe
    # Dst
    dst_PX: dst_px
    dst_PY: dst_py
    dst_PZ: dst_pz
    dst_PE: dst_pe
    # D0
    d0_ID: d0_id
    # Pi
    pi_ID: pi_id
    # Mu
    mu_ID: mu_id
    mu_isMuon: mu_is_mu
    mu_PIDmu: mu_pid_mu

calculation:
    # Temp variables
    v_dst_mom_p: "^auto; TLorentzVector(dst_mc_mom_px, dst_mc_mom_py, dst_mc_mom_pz, dst_mc_mom_pe)"
    v_dst_p: "^auto; TLorentzVector(dst_px, dst_py, dst_pz, dst_pe)"
    mu_pid: "^Bool_t; MU_PID(mu_is_mu, mu_pid_mu)"
    # PID
    dst_id_prod: "Double_t; d0_id*pi_id"   # negative when physical
    id_prod: "Double_t; d0_id*mu_id"       # positive when physical
    # Physical variables
    mm_dst_mom: "Double_t; MM_DST_MOM(v_dst_mom_p, v_dst_p)"  # Missing mass between Dst and its mother
    # Candidate type
    # b_type: (Btype)
    # b_bkg_cat: (Y_BKGCAT) some branch name?
    # dss_type: (Dststtype)
    # Flags
    # flag_dst_sb: "^Bool_t; false" (flagDstSB)
    # flag_tau: "^Bool_t; false" (flagtaumu)
    # flag_two_d_tau: (flagTauonicD)
    # flag_two_d_mu: (flagDoubleD)
    # flag_mu: (flagBmu)
    # Other flags
    is_data: "^Bool_t; IS_DATA(GpsTime)"
    # is_2pi: (ishigher)
    # just_dst: (justDst)
    # dst_ok: ????? always 0. ?????

output:
    b0dst:
        input: TupleB0/DecayTree
        selection:
            - "mu_pid"
            - "iso_bdt < 0.15"
            #- "isdata"  # Well, this doesn't apply to MC
            - "b0_m < 5280"
            # L0 cuts
            - "b0_l0glob_tis || dst_l0had_dec_tos"
            - "mu_l0glob_tis"
