
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://umd-lhcb.github.io/lhcb-ntuples-gen/technical_concepts/truth_matching/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>Truth matching - lhcb-ntuples-gen wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#truth-matching" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="lhcb-ntuples-gen wiki" class="md-header__button md-logo" aria-label="lhcb-ntuples-gen wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            lhcb-ntuples-gen wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Truth matching
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/umd-lhcb/lhcb-ntuples-gen/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    umd-lhcb/lhcb-ntuples-gen
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="lhcb-ntuples-gen wiki" class="md-nav__button md-logo" aria-label="lhcb-ntuples-gen wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    lhcb-ntuples-gen wiki
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/umd-lhcb/lhcb-ntuples-gen/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    umd-lhcb/lhcb-ntuples-gen
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Ntupling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Ntupling" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Ntupling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ntupling/installation/" class="md-nav__link">
        Installing dependencies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ntupling/step1_davinci/" class="md-nav__link">
        Step 1 ntuples with Davinci
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ntupling/step2_babymaker/" class="md-nav__link">
        Step 2 ntuples with babymaker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ntupling/grid_job/" class="md-nav__link">
        Submitting DaVinci jobs to GRID
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ntupling/dev/" class="md-nav__link">
        Developing this project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ntupling/nomenclature/" class="md-nav__link">
        Nomenclature
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Software
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Software" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Software
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/git_annex/" class="md-nav__link">
        git-annex
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          DaVinci
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="DaVinci" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          DaVinci
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/davinci/docker_image_usage/" class="md-nav__link">
        Docker image usage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/davinci/tips_and_tricks/" class="md-nav__link">
        Tips and tricks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/davinci/loki_functors/" class="md-nav__link">
        LoKi functors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/davinci/tuple_tools/" class="md-nav__link">
        TupleTools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/nix/nix/" class="md-nav__link">
        nix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/root/" class="md-nav__link">
        Compiling ROOT
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/bender/" class="md-nav__link">
        bender
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/dirac/" class="md-nav__link">
        DIRAC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/lxplus/" class="md-nav__link">
        Tips for lxplus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../software_manuals/external/" class="md-nav__link">
        External manuals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Physics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Physics" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Physics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/momentum_scaling/" class="md-nav__link">
        Momentum scaling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/wrong_sign_particles/" class="md-nav__link">
        Wrong-sign particles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/b0_oscillation/" class="md-nav__link">
        B0 oscillation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/track_chi2ndof_data_mc_inconsistency/" class="md-nav__link">
        Track χ²/DOF inconsistency in run 2 data-MC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../physics/transverse_energy/" class="md-nav__link">
        Transverse energy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Technical concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Technical concepts" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Technical concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Truth matching
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Truth matching
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#davincismartassociator" class="md-nav__link">
    DaVinciSmartAssociator
  </a>
  
    <nav class="md-nav" aria-label="DaVinciSmartAssociator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neutral-particles" class="md-nav__link">
    Neutral particles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-stable-charged-particles" class="md-nav__link">
    Basic stable charged particles
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_management/" class="md-nav__link">
        Data management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/data_sources/" class="md-nav__link">
        Data sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Cutflows
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cutflows" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Cutflows
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/cutflows/RDst_run1_vs_run2/overview/" class="md-nav__link">
        R(D*) cutflow overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/cutflows/RDst_run1_vs_run2/detail/" class="md-nav__link">
        R(D*) cutflow detail
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/cutflows/RDst_refit_Dst_only_vs_full_refit/" class="md-nav__link">
        R(D*) cutflow to study the effect of refit D* only
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_4" type="checkbox" id="__nav_6_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_4">
          Comparisons
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Comparisons" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_4">
          <span class="md-nav__icon md-icon"></span>
          Comparisons
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/comparison/RDst_vars_run1/RDst_vars_run1/" class="md-nav__link">
        R(D*) variables, run 1
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/comparison/RDst_step2_cuts_validation/RDst_step2_cuts_validation/" class="md-nav__link">
        R(D*) run 1 step-2 cuts validation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../data/comparison/trigger_lines/" class="md-nav__link">
        Trigger lines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#davincismartassociator" class="md-nav__link">
    DaVinciSmartAssociator
  </a>
  
    <nav class="md-nav" aria-label="DaVinciSmartAssociator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neutral-particles" class="md-nav__link">
    Neutral particles
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basic-stable-charged-particles" class="md-nav__link">
    Basic stable charged particles
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/umd-lhcb/lhcb-ntuples-gen/edit/master/docs/technical_concepts/truth_matching.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="truth-matching">Truth-Matching</h1>
<p>In LHCb, the general procedure works as follows:</p>
<ol>
<li>In the MC generation, after <code>Gauss</code> and <code>Boole</code>, <code>Brunel</code> is used to
    reconstruct events.</li>
<li>
<p>During this reconstruction, truth-matching maps for
    <code>ProtoParticle</code>-<code>MCParticle</code> are also created.</p>
<p>This only applies to stable particles in the detector.</p>
<p>An example on truth-matching in <code>Brunel</code> is provided <a href="https://twiki.cern.ch/twiki/bin/view/LHCb/FAQ/BrunelFAQ#How_do_I_implement_MC_truth_matc">in this TWiki</a>.</p>
<div class="admonition info tes locations of the truth-matching tables">
<p class="admonition-title">Info</p>
<p>An example of these TES locations for <code>TurboDst</code> can be found
at <a href="https://twiki.cern.ch/twiki/bin/view/LHCb/MakeNTupleFromTurbo">this TWiki</a>.</p>
</div>
</li>
<li>
<p>Reconstructed events and truth-matching maps are stored in the <code>dst</code> files.</p>
</li>
<li>When reconstructing events in <code>DaVinci</code>, the truth-matching maps are loaded
    from the <code>dst</code> file and used to truth-match stable particles.</li>
<li>For composite particles: Each reconstructed final state daughter of the
    composite Particle has an associated <code>MCParticle</code>, and all these associated
    <code>MCParticle</code>s have the same final <code>MCParticle</code> mother.</li>
</ol>
<p>LHCb has implemented many truth-matching strategies.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Take a look at <a href="https://twiki.cern.ch/twiki/bin/view/LHCb/Particle2MC">the Particle2MC TWiki</a>
for an overview on these strategies.</p>
</div>
<h2 id="davincismartassociator"><code>DaVinciSmartAssociator</code></h2>
<p>In this implementation, truth-matching are separated into 3 categories:</p>
<ol>
<li>Neutral particles (both basic and composite)</li>
<li>Basic stable charged particles</li>
<li>Composite charged particles</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The code below might be phased out as some of them are not present in
<code>master</code> branch of the related projects.</p>
</div>
<h3 id="neutral-particles">Neutral particles</h3>
<p>The truth-matching is done purely with calorimeter info. It is implemented in
<a href="https://gitlab.cern.ch/lhcb/Rec/-/blob/7a48b9c4084f398fa7c867a8e3165e9db7682e16/Calo/CaloTools/src/Calo2MCTool.cpp"><code>Calo2MCTool</code></a>.</p>
<p>The tool returns the MC particle that is <em>best matched</em> to the reconstructed particle.</p>
<p>The MC <code>dst</code> will provide several relation tables for truth-matching. See <a href="https://twiki.cern.ch/twiki/bin/view/LHCb/CaloEventModel#Relations">this TWiki</a>.</p>
<h3 id="basic-stable-charged-particles">Basic stable charged particles</h3>
<p>This is done with <a href="https://gitlab.cern.ch/lhcb/Analysis/-/blob/master/Phys/DaVinciMCTools/src/P2MCPFromProtoP.cpp"><code>P2MCPFromProtoP</code></a>.</p>
<p>It finds the <code>ProtoParticle</code> of the reconstructed <code>Particle</code>. Then use the standard
truth-matching table to find the linked <code>MCParticle</code>.</p>
<h1 id="truth-matching-for-rd-run-2">Truth-Matching for RD(*) Run 2</h1>
<p>For the run 2 R(D(*)) analysis, when postprocessing our MC ntuples, we perform truth-matching copied from Phoebe's code for
the run 1 analysis. Her code for truth-matching can be found in <code>redoHistos_D0.C</code>+<code>AddD0B_tmp.C</code> (for <code>D0</code> sample) and
<code>redoHistos_Dst.C</code>+<code>AddB.C</code> (for <code>D*</code> sample) in this
<a href="https://gitlab.cern.ch/bhamilto/rdvsrdst-histfactory/-/tree/master/proc">proc folder</a> from her run 1 analysis (preservation)
code repo. We implement the truth-matching differently from her in order to work (more understandably) with our workflow; rather than
using flags and filling all histograms (templates) all at the same time based on those flags, we truth-match each decay mode (ie. the <code>MC ID</code>s
listed <a href="https://umd-lhcb.github.io/lhcb-ntuples-gen/data/data_sources/#run-2-muonic-rd-monte-carlo">here</a>) separately and store
the result as a coded integer <code>truthmatch</code> in our postprocessed ntuples.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There is one minor difference of note that results from our differing truth-matching schemes. In Phoebe's implementation, an
event can be used to fill any, and even multiple, templates, not just templates corresponding to the decay mode (eg. an event for
<code>B0-&gt;D*munu</code> MC could pass the truth-matching requirements and thus be filled in for the template corresponding to <code>B0-&gt;D*Xc(-&gt;munuX')X</code>),
and indeed this is seen to occur for a fraction of a percent of all events. On the other hand, our truth-matching takes in the decay mode
that the user wants to truth-match against as an input and will only set <code>truthmatch</code> to a corresponding value for that decay mode.
Additionally, our implementation will never fill in multiple templates with the same event.</p>
</div>
<p>To apply our truth-matching when postprocessing ntuples, using the script found
<a href="https://github.com/umd-lhcb/lhcb-ntuples-gen/blob/a9e19c89da3dfbd7ee0aa34781cd75f6ea7cdd32/include/functor/rdx/truth_match.h">here</a>, in the
configuration <code>YAML</code> file (recall instructions <a href="https://umd-lhcb.github.io/lhcb-ntuples-gen/ntupling/step2_babymaker/">here</a> for postprocessing),
add a <code>calculation</code> integer variable (nominally called <code>truthmatch</code>) that is calculated using either <code>MC_TRUTH_MATCH_DST(...)</code> (for <code>D* sample</code>)
or <code>MC_TRUTH_MATCH_D0(...)</code> (for <code>D0</code> sample). The input parameters for these functions can be found at the bottom of the truth-matching script
linked above. As already mentioned, one required input is the decay mode ID.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The truth-matching code has some optional debugging flags that can be set if one wants to not separate <code>D**(s)</code> cocktails, does want to
separate <code>D**H</code> cocktails, or doesn't want to separate <code>DD</code> cocktails. For now, the <code>DD</code> debug flag is set to true until the code is
developed to actually separate those cocktails (and, in fact, Phoebe does not separate the cocktails for her templates). In the encoding
scheme below, this means that temporarily <code>truthmatch</code> will have <code>b1b2=0</code>. Without setting these flags, the coded <code>truthmatch</code> int is
nominally set to encode all information that should be relevant for building the run 2 R(D(*)) templates.</p>
</div>
<p>Once this is done, the postprocessed ntuples will contain a <code>truthmatch</code> branch that encodes what type of decay the event was successfully
truth-matched to, or <code>truthmatch=0</code> if the event failed to pass the truth-matching requirements. The encoding scheme for <code>truthmatch</code> works as
follows: <code>truthmatch=a1b1b2c1c2d1</code> where</p>
<ol>
<li><code>d1</code>=<ol>
<li>0 if normalization(-like) (ie. without tau)</li>
<li>1 if signal(-like)</li>
</ol>
</li>
<li><code>c1c2</code> are two digits referring to the "primary" <code>D</code> meson. For non-DD decays, this is just the <code>D</code> that the <code>B</code> decays to; for now, for DD
decays,  <code>c1c2=00</code>. Otherwise, <code>c1c2=</code><ol>
<li><code>01</code> for <code>D0</code>, <code>02</code> for <code>D+</code>, <code>03</code> for <code>D*0</code>, <code>04</code> for <code>D*+</code></li>
<li><code>10</code> for all (light) <code>D**^0</code> (ie. cocktail not separated, but it's required that the specific event <code>D**</code> is possible for the
considered decay), <code>11</code> for <code>D0*^0</code>, <code>12</code> for <code>D1^0</code>, <code>13</code> for <code>D1'^0</code>, <code>14</code> for <code>D2*^0</code></li>
<li><code>20</code> for all (light) <code>D**^+</code>, <code>21</code> for <code>D0*^+</code>, <code>22</code> for <code>D1^+</code>, <code>23</code> for <code>D1'^+</code>, <code>24</code> for <code>D2*^+</code></li>
<li><code>30</code> for all heavy <code>D**H^0</code> (again, it's internally required that the <code>D**H</code> is possible), and (for debugging) <code>31</code> for <code>D*(2S)^+</code>, <code>32</code>
for <code>D(2S)^+</code>, <code>33</code> for <code>D(2750)^+</code>, <code>34</code> for <code>D(3000)^+</code></li>
<li><code>40</code> for all heavy <code>D**H^+</code>, and <code>41</code> for <code>D*(2S)^+</code>, <code>42</code> for <code>D(2S)^+</code>, <code>43</code> for <code>D(2750)^+</code>, <code>44</code> for <code>D(3000)^+</code></li>
<li><code>50</code> for all strange <code>D**s</code> (again, internally require specific <code>D**s</code> to be possible), and <code>53</code> for <code>D1'_s</code>, <code>54</code> for <code>D2*_s</code> (to keep
consistent with <code>D**</code> scheme; there aren't any "<code>D0*_s, D1_s</code>")</li>
</ol>
</li>
<li><code>b1b2</code> are used to separate <code>DD</code> cocktails, and will nominally be set to nonzero values for every <code>DD</code> decay. For now, this feature is not
implemented, so it will always be that <code>b1b2=00</code></li>
<li><code>a1</code>=<ol>
<li><code>0</code> if not a <code>D**H</code> or DD decay, and <code>D**-&gt;D(*)pipi</code> decays are cut out if a (light) <code>D**</code> decay</li>
<li><code>1</code> if a <code>DD</code> decay from a <code>B0</code></li>
<li><code>2</code> if a <code>DD</code> decay from a <code>B+</code>  </li>
<li><code>3</code> if a <code>D**H</code> decay where <code>D**H-&gt;D*-&gt;D</code> (useful because Phoebe separates this topology from <code>D**H-&gt;D0</code> directly in her templates for
the <code>D0</code> sample)</li>
<li><code>4</code> if a <code>D**H</code> decay where <code>D**H-&gt;D</code></li>
<li><code>5</code> if a (light) <code>D**</code> decay explicitly with two pion decays (<code>D**-&gt;D(*)pipi</code>) kept</li>
</ol>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>For examples: successful truth-matching to <code>B0-&gt;D*munu</code> will be encoded as <code>000041</code>, <code>B--&gt;D*0munu</code> as <code>000031</code>, <code>B0-&gt;D0taunu</code> as <code>000011</code>,
<code>B0-&gt;D1'taunu</code> (no 2pi) as <code>000231</code>, <code>B+-&gt;D2*(-&gt;D*pipi)munu</code> as <code>500140</code>, <code>B0-&gt;D**H(-&gt;Dpipi)munu</code> as <code>400400</code>, and <code>B+-&gt;D0X(-&gt;munuX)X</code> as <code>200000</code></p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../physics/transverse_energy/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Transverse energy" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Transverse energy
            </div>
          </div>
        </a>
      
      
        
        <a href="../../data/data_management/" class="md-footer__link md-footer__link--next" aria-label="Next: Data management" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Data management
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e84347e.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>